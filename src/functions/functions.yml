getOrders:
  handler: src/functions/query/getOrders/getOrders.handler
  environment:
    ORDER_TABLE: !Ref OrderTable
  iamRoleStatements:
    - Effect: Allow
      Action: dynamodb:Query
      Resource: !Sub ${OrderTable.Arn}/index/byEmailAndCreatedDate
getProducts:
  handler: src/functions/query/getProducts/getProducts.handler
  environment:
    PRODUCT_AND_CATEGORY_TABLE: !Ref ProductAndCategoryTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Query
      Resource: !GetAtt ProductAndCategoryTable.Arn
getCategories:
  handler: src/functions/query/getCategories/getCategories.handler
  environment:
    PRODUCT_AND_CATEGORY_TABLE: !Ref ProductAndCategoryTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:Query
      Resource: !GetAtt ProductAndCategoryTable.Arn
placeOrder:
  handler: src/functions/mutation/placeOrder/placeOrder.handler
  environment:
    ORDER_TABLE: !Ref OrderTable
    PRODUCT_AND_CATEGORY_TABLE: !Ref ProductAndCategoryTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:PutItem
      Resource: !GetAtt OrderTable.Arn
    - Effect: Allow
      Action:
        - dynamodb:GetItem
      Resource: !GetAtt ProductAndCategoryTable.Arn
createProduct:
  handler: src/functions/mutation/createProduct/createProduct.handler
  environment:
    PRODUCT_AND_CATEGORY_TABLE: !Ref ProductAndCategoryTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:PutItem
        - dynamodb:UpdateItem
      Resource: !GetAtt ProductAndCategoryTable.Arn
createCategory:
  handler: src/functions/mutation/createCategory/createCategory.handler
  environment:
    PRODUCT_AND_CATEGORY_TABLE: !Ref ProductAndCategoryTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:PutItem
        - dynamodb:UpdateItem
      Resource: !GetAtt ProductAndCategoryTable.Arn
startProcessingOrder:
  handler: src/functions/mutation/startProcessingOrder/startProcessingOrder.handler
  environment:
    ORDER_TABLE: !Ref OrderTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:GetItem
        - dynamodb:UpdateItem
      Resource: !GetAtt OrderTable.Arn
completeOrder:
  handler: src/functions/mutation/completeOrder/completeOrder.handler
  environment:
    ORDER_TABLE: !Ref OrderTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:GetItem
        - dynamodb:UpdateItem
      Resource: !GetAtt OrderTable.Arn
categories:
  handler: src/functions/field/categories/categories.handler
  environment:
    PRODUCT_AND_CATEGORY_TABLE: !Ref ProductAndCategoryTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:GetItem
      Resource: !GetAtt ProductAndCategoryTable.Arn
products:
  handler: src/functions/field/products/products.handler
  environment:
    PRODUCT_AND_CATEGORY_TABLE: !Ref ProductAndCategoryTable
  iamRoleStatements:
    - Effect: Allow
      Action:
        - dynamodb:GetItem
      Resource: !GetAtt ProductAndCategoryTable.Arn
